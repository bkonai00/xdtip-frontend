<!DOCTYPE html>
<html lang="en">
<head>
    <script>
        if (window.location.pathname.endsWith(".html")) {
            var clean = window.location.pathname.replace(".html", "");
            window.history.replaceState(null, "", clean);
        }
    </script>
    <meta charset="UTF-8">
    <title>Buy Tokens | xdtip</title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>

    <nav>
        <a href="https://tip.xdfun.in/" style="text-decoration:none; color:white;">
            <div class="logo">
                <img src="images/logo.png" alt="XDTIP" style="height: 40px; vertical-align: middle;">
            </div>
        </a>
        <div class="nav-links">
            </div>
    </nav>

    <div style="padding: 100px 20px; text-align: center;">
        <h1 style="font-size: 48px;">Top Up Wallet</h1>
        <p style="color: #888; margin-bottom: 60px;">Select a token pack. 1 INR = 1 Token.</p>

        <div class="pricing-grid">
            <div class="price-card" onclick="buyTokens(10)">
                <h2 style="font-size: 42px; margin: 10px 0;">10</h2>
                <p style="color: #888;">Tokens</p>
                <div style="background: #222; padding: 10px; margin-top: 20px; border-radius: 6px;">₹10</div>
            </div>

            <div class="price-card popular" onclick="buyTokens(100)">
                <div class="badge">BEST VALUE</div>
                <h2 style="font-size: 42px; margin: 10px 0; color: #ff3b3b;">100</h2>
                <p style="color: #888;">Tokens</p>
                <div style="background: #ff3b3b; color: white; padding: 10px; margin-top: 20px; border-radius: 6px;">₹100</div>
            </div>

            <div class="price-card" onclick="buyTokens(500)">
                <h2 style="font-size: 42px; margin: 10px 0;">500</h2>
                <p style="color: #888;">Tokens</p>
                <div style="background: #222; padding: 10px; margin-top: 20px; border-radius: 6px;">₹500</div>
            </div>
        </div>

        <p style="margin-top: 50px; font-size: 12px; color: #444;">Secure payments via Razorpay</p>
    </div>

    <footer>
        <p>&copy; 2024 xdtip. All rights reserved.</p>
        <div class="footer-links">
            <a href="/privacy/">Privacy Policy</a>
            <a href="/terms/">Terms of Service</a>
            <a href="/refund-policy/">Refund Policy</a>
            <a href="/contact/">Contact Us</a>
        </div>
    </footer>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <script>
        // ⚠️ PASTE YOUR KEYS HERE
        const mySupabaseUrl = 'https://abatvqodkwjdefhwwynj.supabase.co'; 
        const mySupabaseKey = 'sb_publishable_TePONQyxqJL1A-zaO-iUeQ_h8lAllWV'; 
        
        const buyClient = window.supabase.createClient(mySupabaseUrl, mySupabaseKey);
        const RAZORPAY_LINK = "https://rzp.io/rzp/xd-token"; 

        async function buyTokens(amount) {
            // 1. Check Login Status
            const { data: { user }, error } = await buyClient.auth.getUser();

            if (error || !user) {
                alert("Please log in to purchase tokens.");
                window.location.href = "login.html";
                return;
            }

            // 2. Get Username (for the reminder)
            let username = "User";
            try {
                const { data: profile } = await buyClient
                    .from('users')
                    .select('username')
                    .eq('id', user.id)
                    .single();
                
                if (profile) username = profile.username;
            } catch (err) {
                console.error(err);
            }

            // 3. Open Payment Gateway with Reminder
            const proceed = confirm(`You are logged in as: ${username}\n\n⚠️ IMPORTANT: Please enter this exact username on the payment page so we can credit your wallet.\n\nProceed to payment?`);
            
            if (proceed) {
                window.open(RAZORPAY_LINK, '_blank');
            }
        }
    </script>

</body>
</html>




